<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat with Mohammad Ajij</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script> <!-- Add Marked.js library -->
    <style>
        :root {
            --primary: #4CAF50; /* Green */
            --primary-light: #81C784;
            --secondary: #2196F3; /* Blue */
            --accent: #FFC107; /* Amber */
            --dark: #263238; /* Dark Grey */
            --darker: #1C2428;
            --light: #ECEFF1; /* Light Grey */
            --user-bubble: #BBDEFB; /* Light Blue */
            --bot-bubble: #E8F5E9; /* Light Green */
            --header-height: 70px;
            --input-height: 70px;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Roboto', sans-serif;
            background: linear-gradient(135deg, var(--darker), var(--dark));
            color: var(--light);
            min-height: 100vh;
            overflow: hidden;
            position: relative;
        }
        
        body::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 10% 20%, rgba(76, 175, 80, 0.15) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(33, 150, 243, 0.15) 0%, transparent 20%),
                radial-gradient(circle at 30% 60%, rgba(255, 193, 7, 0.1) 0%, transparent 25%),
                radial-gradient(circle at 70% 30%, rgba(187, 222, 251, 0.1) 0%, transparent 25%);
            z-index: -1;
        }
        
        .chat-container {
            display: flex;
            flex-direction: column;
            max-width: 900px;
            height: 100vh;
            margin: 0 auto;
            background: rgba(38, 50, 56, 0.9);
            backdrop-filter: blur(10px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            border-radius: 0;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .chat-header {
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            color: white;
            padding: 15px 25px;
            display: flex;
            align-items: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            z-index: 10;
            position: relative;
        }
        
        .profile-pic {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            border: 2px solid white;
            overflow: hidden; 
        }

        .profile-pic img { 
            width: 100%;
            height: 100%;
            object-fit: cover; 
            display: block;
        }
        
        .profile-pic i {
            font-size: 24px;
            color: var(--primary);
        }
        
        .header-content {
            flex: 1;
        }
        
        .chat-header h1 {
            font-family: 'Poppins', sans-serif;
            font-size: 24px;
            font-weight: 600;
            margin: 0;
            display: flex;
            align-items: center;
        }
        
        .status {
            display: flex;
            align-items: center;
            font-size: 13px;
            margin-top: 3px;
            color: rgba(255, 255, 255, 0.8);
        }
        
        .status-dot {
            width: 8px;
            height: 8px;
            background-color: #4ade80;
            border-radius: 50%;
            margin-right: 6px;
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 0.7; }
            50% { opacity: 1; }
            100% { opacity: 0.7; }
        }
        
        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            scroll-behavior: smooth;
        }
        
        .message {
            max-width: 80%;
            padding: 15px 20px;
            border-radius: 25px;
            position: relative;
            line-height: 1.5;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            animation: messageAppear 0.3s ease-out;
            word-wrap: break-word;
            font-size: 16px;
        }
        
        @keyframes messageAppear {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .message.user {
            background: var(--user-bubble);
            color: #333;
            align-self: flex-end;
            border-bottom-right-radius: 8px;
        }
        
        .message.bot {
            background: var(--bot-bubble);
            color: #333;
            align-self: flex-start;
            border-bottom-left-radius: 8px;
        }
        
        .message-time {
            display: block;
            font-size: 11px;
            opacity: 0.7;
            margin-top: 5px;
            text-align: right;
            color: #555;
        }
        
        /* New styling for Markdown elements within messages */
        .message-text strong {
            font-weight: 600; /* Make bold text more prominent */
            color: var(--dark); /* Adjust color if needed */
        }
        .message-text ul, .message-text ol {
            margin-left: 20px;
            padding-left: 0;
            margin-top: 5px;
            margin-bottom: 5px;
        }
        .message-text li {
            margin-bottom: 3px;
        }
        .message-text p {
            margin-bottom: 8px; /* Add some space between paragraphs */
        }
        .message-text p:last-child {
            margin-bottom: 0;
        }


        .message.typing {
            display: flex;
            align-items: center;
            padding: 15px 20px;
        }
        
        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .typing-dot {
            width: 10px;
            height: 10px;
            background-color: #555;
            border-radius: 50%;
            opacity: 0.6;
        }
        
        .typing-dot:nth-child(1) { animation: typing 1.2s infinite; }
        .typing-dot:nth-child(2) { animation: typing 1.2s infinite 0.4s; }
        .typing-dot:nth-child(3) { animation: typing 1.2s infinite 0.8s; }
        
        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); opacity: 0.6; }
            30% { transform: translateY(-5px); opacity: 1; }
        }
        
        .chat-input-area {
            display: flex;
            padding: 15px;
            background: rgba(30, 40, 45, 0.8);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        #userInput {
            flex: 1;
            padding: 16px 20px;
            border: none;
            border-radius: 30px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 16px;
            outline: none;
            transition: all 0.3s;
        }
        
        #userInput:focus {
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 0 0 2px var(--primary-light);
        }
        
        #userInput::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }
        
        #sendButton {
            width: 55px;
            height: 55px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            margin-left: 15px;
            display: flex;
            align-items: center;
            justify-content;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
        }
        
        #sendButton:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 6px 20px rgba(76, 175, 80, 0.5);
        }
        
        #sendButton:disabled {
            opacity: 0.5;
            transform: none;
            box-shadow: none;
            cursor: not-allowed;
        }
        
        .chat-messages::-webkit-scrollbar {
            width: 8px;
        }
        
        .chat-messages::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }
        
        .chat-messages::-webkit-scrollbar-thumb {
            background: linear-gradient(var(--primary), var(--secondary));
            border-radius: 10px;
        }
        
        .welcome-banner {
            text-align: center;
            padding: 15px;
            background: linear-gradient(90deg, rgba(76, 175, 80, 0.3), rgba(33, 150, 243, 0.3));
            font-size: 14px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        @media (max-width: 768px) {
            .chat-container {
                border-radius: 0;
            }
            
            .chat-header h1 {
                font-size: 20px;
            }
            
            .message {
                max-width: 90%;
            }
        }
    </style>
</head>
<body>
    <div class="chat-container">
        <div class="chat-header">
            <div class="profile-pic">
                <!-- IMPORTANT: Replace 'https://via.placeholder.com/45' with the actual URL/path to your image -->
                <img src="ajij.png" alt="Mohammad Ajij Profile Picture"> 
            </div>
            <div class="header-content">
                <h1>Mohammad Ajij - Software Engineer</h1>
                <div class="status">
                    <span class="status-dot"></span>
                    Online - Available
                </div>
            </div>
        </div>
        
        <div class="welcome-banner">
            <i class="fas fa-briefcase"></i> Connect with Mohammad Ajij - Ask about his expertise! <i class="fas fa-code"></i>
        </div>
        
        <div class="chat-messages" id="chatMessages">
            <div class="message bot">
                <span class="message-text">Hello! I'm Mohammad Ajij. How can I assist you today? Feel free to ask about my experience, projects, or skills!</span>
                <span class="message-time">Just now</span>
            </div>
        </div>
        
        <div class="chat-input-area">
            <input type="text" id="userInput" placeholder="Message Mohammad Ajij...">
            <button id="sendButton">
                <i class="fas fa-paper-plane"></i>
            </button>
        </div>
    </div>

    <script>
        // --- Configuration ---
        const GEMINI_API_KEY = "AIzaSyBWADEx3wSRPKhj0-SQr3kf8fzeR46bPFE"; 

        const systemInstructionText = `
        You are Mohammad Ajij, a software engineer and fresh graduate student of Information and Communication Engineering at  
        Noakhali Science and Technology University (NSTU). 

        You have completed an internship at Business Automation Ltd., 
        where you worked on web projects using PHP, JavaScript, HTML, and CSS. 
        You are passionate about programming competitions and have achieved top results.

        Your technical skills include:
        - Languages: C, C++, Java, Assembly
        - Web: HTML, CSS, JavaScript, PHP, TypeScript, Angular, ReactJS, Spring Boot
        - Tools: Git, GitHub
        - Database: MySQL

        You love solving problems on Codeforces, LeetCode, and CodeChef, 
        with over 1400+ problems solved and 150+ contests participated.

        You enjoy coding challenges and working on impactful web projects like  
        "Academic Collaboration and Resource Sharing Platform" and "ICE Alumni Network Portal".

        Speak politely, confidently, and professionally — like a software engineer introducing himself. 
        Use short, clear, and friendly sentences.
        Avoid excessively long paragraphs.
        When providing lists or bullet points, format them clearly using markdown.
        `; // Added prompt adjustments here

        const History = [];

        // --- Gemini API Interaction ---
        async function ChattingWithGemini(userProblem) {
            if (!GEMINI_API_KEY) {
                return "API key is not set. Please provide a valid Gemini API key.";
            }

            History.push({
                role: 'user',
                parts: [{ text: userProblem }]
            });

            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${GEMINI_API_KEY}`;

            const requestBody = {
                contents: History,
                systemInstruction: {
                    parts: [{ text: systemInstructionText }]
                },
                generationConfig: {
                    temperature: 0.6, // Slightly reduced temperature for less verbosity/creativity
                    maxOutputTokens: 500, // Reduced max output tokens to encourage shorter responses
                },
                safetySettings: [
                    { "category": "HARM_CATEGORY_HARASSMENT", "threshold": "BLOCK_NONE" },
                    { "category": "HARM_CATEGORY_HATE_SPEECH", "threshold": "BLOCK_NONE" },
                    { "category": "HARM_CATEGORY_SEXUALLY_EXPLICIT", "threshold": "BLOCK_NONE" },
                    { "category": "HARM_CATEGORY_DANGEROUS_CONTENT", "threshold": "BLOCK_NONE" }
                ]
            };

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(requestBody)
                });

                const responseData = await response.json();

                if (!response.ok) {
                    console.error("API Error Response:", responseData);
                    const errorMessage = responseData.error?.message || `API request failed with status ${response.status}`;
                    History.push({
                        role: 'model',
                        parts: [{ text: `API Error: ${errorMessage}` }]
                    });
                    return `An API error occurred: ${errorMessage}. Please check the console for more details.`;
                }
                
                let botResponseText = "I apologize, but I couldn't understand your request. Could you please rephrase it?";
                if (responseData.candidates && responseData.candidates.length > 0 &&
                    responseData.candidates[0].content && responseData.candidates[0].content.parts &&
                    responseData.candidates[0].content.parts.length > 0) {
                    botResponseText = responseData.candidates[0].content.parts[0].text;
                } else if (responseData.promptFeedback && responseData.promptFeedback.blockReason) {
                    botResponseText = `I'm unable to respond to that due to content policy. Please ask something else.`;
                    console.warn("Prompt blocked:", responseData.promptFeedback);
                } else {
                    console.warn("Unexpected API response structure:", responseData);
                }

                History.push({
                    role: 'model',
                    parts: [{ text: botResponseText }]
                });
                
                const maxHistoryItems = 20; 
                if (History.length > maxHistoryItems) {
                    History.splice(0, History.length - maxHistoryItems);
                }

                return botResponseText;

            } catch (error) {
                console.error("Error fetching from Gemini API:", error);
                History.push({
                    role: 'model',
                    parts: [{ text: `Network/Fetch Error: ${error.message}` }]
                });
                return `A network error occurred: ${error.message}. Please check your connection.`;
            }
        }

        // --- Frontend UI Logic ---
        document.addEventListener('DOMContentLoaded', () => {
            const chatMessagesEl = document.getElementById('chatMessages');
            const userInputEl = document.getElementById('userInput');
            const sendButtonEl = document.getElementById('sendButton');
            
            function addMessageToUI(text, sender, isTyping = false) {
                const messageElement = document.createElement('div');
                messageElement.classList.add('message', sender);
                
                if (isTyping) {
                    messageElement.classList.add('typing');
                    messageElement.innerHTML = `
                        <div class="typing-indicator">
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                        </div>
                    `;
                } else {
                    // Use Marked.js to convert Markdown to HTML
                    const htmlContent = marked.parse(text); 
                    messageElement.innerHTML = `
                        <span class="message-text">${htmlContent}</span>
                        <span class="message-time">${getCurrentTime()}</span>
                    `;
                }
                
                chatMessagesEl.appendChild(messageElement);
                chatMessagesEl.scrollTop = chatMessagesEl.scrollHeight;
                return messageElement;
            }
            
            function getCurrentTime() {
                const now = new Date();
                return `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;
            }

            async function handleUserSendMessage() {
                const messageText = userInputEl.value.trim();
                if (messageText === '') return;

                addMessageToUI(messageText, 'user');
                userInputEl.value = '';
                userInputEl.focus();

                const typingIndicator = addMessageToUI('', 'bot', true);

                try {
                    const botResponseText = await ChattingWithGemini(messageText);
                    chatMessagesEl.removeChild(typingIndicator);
                    addMessageToUI(botResponseText, 'bot');
                } catch (error) {
                    console.error("Unhandled error in send message:", error);
                    chatMessagesEl.removeChild(typingIndicator);
                    addMessageToUI("An unexpected error occurred. Please try again.", 'bot');
                }
            }

            sendButtonEl.addEventListener('click', handleUserSendMessage);
            userInputEl.addEventListener('keypress', (event) => {
                if (event.key === 'Enter') {
                    handleUserSendMessage();
                }
            });
            
            userInputEl.focus();
        });
    </script>
</body>
</html>